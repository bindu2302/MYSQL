Triggers: A Trigger, in the context of databases, is a special type of Stored procedure that automatically executes or fires in response to specific events on
particular tables or views. These events can include actions like insert,update,delete.

Benefits of Triggers in MySQL:

1. Automatic Actions: Triggers run automatically before or after changes (INSERT, UPDATE, DELETE), ensuring consistent behavior without 
   writing extra code in applications.
2. Data Integrity Enforcement: You can enforce business rules at the database level (e.g., prevent negative balances).
3. Audit Logging: Automatically log changes to a table (e.g., who changed what and when).
4.Cascade Changes: Keep related tables in sync (e.g., auto-update a timestamp in a parent table when a child table is modified).
5.Reduced Application Logic: Business rules stay in the database rather than being duplicated in multiple application layers.

Syntax:
DELIMITER //
CREATE TRIGGER trigger_name
{BEFORE | AFTER} {INSERT | UPDATE | DELETE}
ON table_name
FOR EACH ROW
BEGIN
    -- trigger logic here
END;
//

DELIMITER ;


Example 1:
-- Trigger

create table orderdetail(order_id int, product_id int, quantity int);
insert into orderdetail values(101,1,20),(102,2,30),(103,3,25),(104,4,15);
select * from orderdetail;


create table product(product_id int, quantity int);
insert into product values(1,100),(2,150),(3,183),(4,120),(5,80);
select * from product;


DELIMITER //

CREATE TRIGGER UpdateProduct
AFTER INSERT ON orderdetail
FOR EACH ROW
BEGIN
    UPDATE product
    SET quantity = quantity - NEW.quantity
    WHERE product_id = NEW.Product_id;
END;
//

DELIMITER ;

-- SET sql_safe_updates = 0;

select * from orderdetail;

insert into orderdetail values(105,5,10);

select * from product;


-- example 2
select * from orderdetail;

delimiter //
create trigger DeleteProductQuantity
after delete on orderdetail
for each row
BEGIN
update product
set quantity = quantity + OLD.quantity
where product_id = OLD.product_id;
end;
//
delimiter ;


delete from orderdetail where order_id=105;

select * from orderdetail;
select * from product;

drop trigger DeleteProductQuantity;

-- example 3

select * from employee;
alter table employee add salary decimal(10,2);
UPDATE employee SET salary = 50000.00 WHERE emp_id = 1;
UPDATE employee SET salary = 60000.00 WHERE emp_id = 2;
UPDATE employee SET salary = 23000.00 WHERE emp_id = 3;
UPDATE employee SET salary = 10000.00 WHERE emp_id = 4;
UPDATE employee SET salary = 77000.00 WHERE emp_id = 5;


CREATE TABLE audit_employee_salary (
    emp_id INT,
    emp_name VARCHAR(100),
    old_salary DECIMAL(10,2),
    new_salary DECIMAL(10,2),
    change_date DATETIME
);

INSERT INTO audit_employee_salary (emp_id, emp_name, old_salary, new_salary, change_date)
VALUES 
(1, 'john', 40000.00, 50000.00, NOW()),
(2, 'alice', 45000.00, 60000.00, NOW()),
(3, 'robert', 20000.00, 23000.00, NOW()),
(4, 'anitha', 8000.00, 10000.00, NOW()),
(5, 'kevin', 70000.00, 77000.00, NOW());

select * from audit_employee_salary;

DELIMITER //
CREATE TRIGGER after_salary_update
AFTER UPDATE ON employee
FOR EACH ROW
BEGIN
    IF OLD.salary != NEW.salary THEN
        INSERT INTO audit_employee_salary (emp_id,emp_name, old_salary, new_salary, change_date)
        VALUES (OLD.emp_id, OLD.salary, NEW.salary, NOW());
    END IF;
END;
//
DELIMITER ;


UPDATE employee SET salary = 90000.00 WHERE emp_id = 2;

select * from audit_employee_salary;
select * from employee;
drop trigger after_salary_update;

